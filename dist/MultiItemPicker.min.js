/*! multiitempicker - v0.1.0 - 2013-04-25
* https://github.com/theJoeBiz/MultiItemPicker
* Copyright (c) 2013 Joe Duchnowski; Licensed MIT */
(function(t){t.MultiItemPicker=function(e,o){function n(){i(),d(),o.generateElements!==!1&&a(),f(),o.styleElements!==!1&&u(),r()}function r(){x(b.fromBox,b.toBox),o.keepAlphabetical&&(p(b.fromBox,b.toBox),b.fromBox.find("option:first").length?(b.fromBox.find("option:first").attr("selected",!0),l("add")):b.toBox.find("option:first").length?(b.toBox.find("option:first").attr("selected",!0),l("remove")):l("none"))}function i(){b.fromBox=v.find(".fromBox:first"),b.fromBox.length||o.generateElements===!1||(b.fromBox=t("<select/>")),b.fromBox.addClass("fromBox").attr("multiple",!0),b.addButton=v.find(".addButton:first"),b.addButton.length||o.generateElements===!1||(b.addButton=t("<button>Add &gt;</button>")),b.addButton.addClass("addButton"),b.removeButton=v.find(".removeButton:first"),b.removeButton.length||o.generateElements===!1||(b.removeButton=t("<button>&lt; Remove</button>")),b.removeButton.addClass("removeButton"),b.toBox=v.find(".toBox:first"),b.toBox.length||o.generateElements===!1||(b.toBox=t("<select/>")),b.toBox.addClass("toBox").attr("multiple",!0)}function d(){var e=function(e,o){if(o&&o instanceof Array&&o.length)for(var n=0;o.length>n;n++){var r,i,d=o[n];d instanceof Array&&d.length?(r=d[0],i=d[1]||r):"string"==typeof d&&(r=d,i=d);var a=t("<option/>");a.text(r),a.val(i),a.appendTo(e)}};e(b.fromBox,o.fromBoxItems),e(b.toBox,o.toBoxItems)}function a(){var e=v.is("table")?v:t("<table/>").appendTo(v);e.addClass("multiItemPicker");var o=t("<tr/>").appendTo(e);b.leftCell=t("<td/>").append(b.fromBox).addClass("leftCell").appendTo(o),b.middleCell=t("<td/>").append(b.addButton).append(b.removeButton).addClass("middleCell").appendTo(o),b.rightCell=t("<td/>").append(b.toBox).addClass("rightCell").appendTo(o)}function f(){b.fromBox.length&&b.fromBox.dblclick(m),b.toBox.length&&b.toBox.dblclick(c),b.addButton.length&&b.addButton.click(m),b.removeButton.length&&b.removeButton.click(c),b.fromBox.length&&b.fromBox.change(function(){x(b.toBox),l("add")}),b.toBox.length&&b.toBox.change(function(){x(b.fromBox),l("remove")})}function l(t){b.addButton.attr("disabled","add"!==t),b.removeButton.attr("disabled","remove"!==t)}function u(){o.styles!==!1&&t.each(o.styles,function(e){t.each(o.styles[e],function(t,o){b[e]&&b[e].css(t,o)})})}function m(){var t=b.fromBox.find("option:selected").remove();s(t)}function s(t){g(o.beforeAdding),b.toBox.append(t),l("remove"),x(b.fromBox),o.keepAlphabetical&&p(b.toBox),g(o.afterAdded)}function c(){var t=b.toBox.find("option:selected").remove();B(t)}function B(t){g(o.beforeRemoving),b.fromBox.append(t),l("add"),x(b.toBox),o.keepAlphabetical&&p(b.fromBox),g(o.afterRemoved)}function x(){for(var t=0;arguments.length>t;t++)arguments[t].find("option:selected").attr("selected",!1)}function p(){for(var e=function(e,o){var n=t(e).text(),r=t(o).text();return r>n?-1:n>r?1:0},o=function(t,e){r.append(e)},n=0;arguments.length>n;n++){var r=arguments[n],i=r.find("option").get();i.sort(e),t.each(i,o)}}function g(t){return"function"==typeof t?t(b.fromBox,b.toBox):!0}function h(e){var o=[];return e&&e.length?(t.each(e,function(e,n){var r=t(n).text(),i=t(n).val();o.push({text:r,value:i})}),o):o}var v=t(e),b={},k={getRightBoxItems:function(){i();var t=b.toBox.find("option");return h(t)},getLeftBoxItems:function(){i();var t=b.fromBox.find("option");return h(t)}};if("string"==typeof o){if(i(),k[o])return k[o]();throw Error("A method named "+o+" does not exist in the MultiItemPicker plugin.")}if("object"!=typeof o)throw Error("The MultiItemPicker plugin requires the first argument to be an object or string.");n()},t.MultiItemPicker.defaults={styles:{fromBox:{minWidth:150,minHeight:200},toBox:{minWidth:150,minHeight:200},addButton:{display:"block",width:"100%"},removeButton:{display:"block",width:"100%"},middleCell:{paddingLeft:10,paddingRight:10}}},t.fn.extend({MultiItemPicker:function(e,o){if(e&&"object"!=typeof e){if("string"==typeof e)return new t.MultiItemPicker(this,e,o)}else e=t.extend({},t.MultiItemPicker.defaults,e);return t.each(this,function(){new t.MultiItemPicker(this,e,o)}),this}})})(jQuery);