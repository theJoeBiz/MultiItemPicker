/*! multiitempicker - v0.1.0 - 2013-04-25
* https://github.com/theJoeBiz/MultiItemPicker
* Copyright (c) 2013 Joe Duchnowski; Licensed MIT */
(function(t){t.MultiItemPicker=function(e,n){function o(){r(),l(),n.generateElements!==!1&&d(),a(),n.styleElements!==!1&&u(),i()}function i(){B(b.leftBox,b.rightBox),n.keepAlphabetical&&(p(b.leftBox,b.rightBox),b.leftBox.find("option:first").length?(b.leftBox.find("option:first").attr("selected",!0),f("add")):b.rightBox.find("option:first").length?(b.rightBox.find("option:first").attr("selected",!0),f("remove")):f("none"))}function r(){b.leftBox=v.find(".leftBox:first"),b.leftBox.length||n.generateElements===!1||(b.leftBox=t("<select/>")),b.leftBox.addClass("leftBox").attr("multiple",!0),b.addButton=v.find(".addButton:first"),b.addButton.length||n.generateElements===!1||(b.addButton=t("<button>Add &gt;</button>")),b.addButton.addClass("addButton"),b.removeButton=v.find(".removeButton:first"),b.removeButton.length||n.generateElements===!1||(b.removeButton=t("<button>&lt; Remove</button>")),b.removeButton.addClass("removeButton"),b.rightBox=v.find(".rightBox:first"),b.rightBox.length||n.generateElements===!1||(b.rightBox=t("<select/>")),b.rightBox.addClass("rightBox").attr("multiple",!0)}function l(){var e=function(e,n){if(n&&n instanceof Array&&n.length)for(var o=0;n.length>o;o++){var i,r,l=n[o];l instanceof Array&&l.length?(i=l[0],r=l[1]||i):"string"==typeof l&&(i=l,r=l);var d=t("<option/>");d.text(i),d.val(r),d.appendTo(e)}};e(b.leftBox,n.leftBoxItems),e(b.rightBox,n.rightBoxItems)}function d(){var e=v.is("table")?v:t("<table/>").appendTo(v);e.addClass("multiItemPicker");var n=t("<tr/>").appendTo(e);b.leftCell=t("<td/>").append(b.leftBox).addClass("leftCell").appendTo(n),b.middleCell=t("<td/>").append(b.addButton).append(b.removeButton).addClass("middleCell").appendTo(n),b.rightCell=t("<td/>").append(b.rightBox).addClass("rightCell").appendTo(n)}function a(){b.leftBox.length&&b.leftBox.dblclick(s),b.rightBox.length&&b.rightBox.dblclick(c),b.addButton.length&&b.addButton.click(s),b.removeButton.length&&b.removeButton.click(c),b.leftBox.length&&b.leftBox.change(function(){B(b.rightBox),f("add")}),b.rightBox.length&&b.rightBox.change(function(){B(b.leftBox),f("remove")})}function f(t){b.addButton.attr("disabled","add"!==t),b.removeButton.attr("disabled","remove"!==t)}function u(){n.styles!==!1&&t.each(n.styles,function(e){t.each(n.styles[e],function(t,n){b[e]&&b[e].css(t,n)})})}function s(){var t=b.leftBox.find("option:selected").remove();g(t)}function g(t){x(n.beforeAdding),b.rightBox.append(t),f("remove"),B(b.leftBox),n.keepAlphabetical&&p(b.rightBox),x(n.afterAdded)}function c(){var t=b.rightBox.find("option:selected").remove();h(t)}function h(t){x(n.beforeRemoving),b.leftBox.append(t),f("add"),B(b.rightBox),n.keepAlphabetical&&p(b.leftBox),x(n.afterRemoved)}function B(){for(var t=0;arguments.length>t;t++)arguments[t].find("option:selected").attr("selected",!1)}function p(){for(var e=function(e,n){var o=t(e).text(),i=t(n).text();return i>o?-1:o>i?1:0},n=function(t,e){i.append(e)},o=0;arguments.length>o;o++){var i=arguments[o],r=i.find("option").get();r.sort(e),t.each(r,n)}}function x(t){return"function"==typeof t?t(b.leftBox,b.rightBox):!0}function m(e){var n=[];return e&&e.length?(t.each(e,function(e,o){var i=t(o).text(),r=t(o).val();n.push({text:i,value:r})}),n):n}var v=t(e),b={},k={getRightBoxItems:function(){r();var t=b.rightBox.find("option");return m(t)},getLeftBoxItems:function(){r();var t=b.leftBox.find("option");return m(t)}};if("string"==typeof n){if(r(),k[n])return k[n]();throw Error("A method named "+n+" does not exist in the MultiItemPicker plugin.")}if("object"!=typeof n)throw Error("The MultiItemPicker plugin requires the first argument to be an object or string.");o()},t.MultiItemPicker.defaults={generateElements:!0,styleElements:!0,keepAlphabetical:!0,styles:{leftBox:{minWidth:150,minHeight:200},rightBox:{minWidth:150,minHeight:200},addButton:{display:"block",width:"100%"},removeButton:{display:"block",width:"100%"},middleCell:{paddingLeft:10,paddingRight:10}}},t.fn.extend({MultiItemPicker:function(e,n){if(e&&"object"!=typeof e){if("string"==typeof e)return new t.MultiItemPicker(this,e,n)}else e=t.extend({},t.MultiItemPicker.defaults,e);return t.each(this,function(){new t.MultiItemPicker(this,e,n)}),this}})})(jQuery);